<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: TicketRequestsHelper
  
    &mdash; &quot;Ticket Booth for Communities&quot;
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "TicketRequestsHelper";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index (T)</a> &raquo;
    
    
    <span class="title">TicketRequestsHelper</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: TicketRequestsHelper
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>app/helpers/ticket_requests_helper.rb</dd>
  </dl>
  
</div>








  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#class_for_table_row-instance_method" title="#class_for_table_row (instance method)">#<strong>class_for_table_row</strong>(ticket_request)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#eald_paid%3F-instance_method" title="#eald_paid? (instance method)">#<strong>eald_paid?</strong>(ticket_request)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Not perfect, but looks up the email address associated with the request and
checks if enough EA/LD passes have been purchased with that email address
to meet or exceed the originally requested amount in the request.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#eald_requested%3F-instance_method" title="#eald_requested? (instance method)">#<strong>eald_requested?</strong>(ticket_request)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#help_text_for-instance_method" title="#help_text_for (instance method)">#<strong>help_text_for</strong>(sym)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#price_rules_to_json-instance_method" title="#price_rules_to_json (instance method)">#<strong>price_rules_to_json</strong>(event)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#text_class_for_status-instance_method" title="#text_class_for_status (instance method)">#<strong>text_class_for_status</strong>(ticket_request)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#text_for_status-instance_method" title="#text_for_status (instance method)">#<strong>text_for_status</strong>(ticket_request)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="class_for_table_row-instance_method">
  
    #<strong>class_for_table_row</strong>(ticket_request)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


3
4
5
6
7
8
9
10</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/helpers/ticket_requests_helper.rb', line 3</span>

<span class='kw'>def</span> <span class='id identifier rubyid_class_for_table_row'>class_for_table_row</span><span class='lparen'>(</span><span class='id identifier rubyid_ticket_request'>ticket_request</span><span class='rparen'>)</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_ticket_request'>ticket_request</span><span class='period'>.</span><span class='id identifier rubyid_status'>status</span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>P</span><span class='tstring_end'>&#39;</span></span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>warning</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>A</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_ticket_request'>ticket_request</span><span class='period'>.</span><span class='id identifier rubyid_payment'>payment</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>info</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>success</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="eald_paid?-instance_method">
  
    #<strong>eald_paid?</strong>(ticket_request)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Not perfect, but looks up the email address associated with the request and
checks if enough EA/LD passes have been purchased with that email address
to meet or exceed the originally requested amount in the request.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


50
51
52
53
54
55
56
57</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/helpers/ticket_requests_helper.rb', line 50</span>

<span class='kw'>def</span> <span class='id identifier rubyid_eald_paid?'>eald_paid?</span><span class='lparen'>(</span><span class='id identifier rubyid_ticket_request'>ticket_request</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_eald_payments'>eald_payments</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="EaldPayment.html" title="EaldPayment (class)">EaldPayment</a></span></span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>event:</span> <span class='id identifier rubyid_ticket_request'>ticket_request</span><span class='period'>.</span><span class='id identifier rubyid_event'>event</span><span class='comma'>,</span>
                                    <span class='label'>email:</span> <span class='id identifier rubyid_ticket_request'>ticket_request</span><span class='period'>.</span><span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span>
  <span class='id identifier rubyid_ea_passes'>ea_passes</span> <span class='op'>=</span> <span class='id identifier rubyid_eald_payments'>eald_payments</span><span class='period'>.</span><span class='id identifier rubyid_sum'>sum</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:early_arrival_passes</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_ld_passes'>ld_passes</span> <span class='op'>=</span> <span class='id identifier rubyid_eald_payments'>eald_payments</span><span class='period'>.</span><span class='id identifier rubyid_sum'>sum</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:late_departure_passes</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_ea_passes'>ea_passes</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_ticket_request'>ticket_request</span><span class='period'>.</span><span class='id identifier rubyid_early_arrival_passes'>early_arrival_passes</span> <span class='op'>&amp;&amp;</span>
    <span class='id identifier rubyid_ld_passes'>ld_passes</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_ticket_request'>ticket_request</span><span class='period'>.</span><span class='id identifier rubyid_late_departure_passes'>late_departure_passes</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="eald_requested?-instance_method">
  
    #<strong>eald_requested?</strong>(ticket_request)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


42
43
44
45</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/helpers/ticket_requests_helper.rb', line 42</span>

<span class='kw'>def</span> <span class='id identifier rubyid_eald_requested?'>eald_requested?</span><span class='lparen'>(</span><span class='id identifier rubyid_ticket_request'>ticket_request</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_ticket_request'>ticket_request</span><span class='period'>.</span><span class='id identifier rubyid_early_arrival_passes'>early_arrival_passes</span> <span class='op'>&gt;</span> <span class='int'>0</span> <span class='op'>||</span>
    <span class='id identifier rubyid_ticket_request'>ticket_request</span><span class='period'>.</span><span class='id identifier rubyid_late_departure_passes'>late_departure_passes</span> <span class='op'>&gt;</span> <span class='int'>0</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="help_text_for-instance_method">
  
    #<strong>help_text_for</strong>(sym)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/helpers/ticket_requests_helper.rb', line 67</span>

<span class='kw'>def</span> <span class='id identifier rubyid_help_text_for'>help_text_for</span><span class='lparen'>(</span><span class='id identifier rubyid_sym'>sym</span><span class='rparen'>)</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_sym'>sym</span>
  <span class='kw'>when</span> <span class='symbol'>:email</span>
    <span class='heredoc_beg'>&lt;&lt;-HELP</span>
<span class='tstring_content'>    You will use this email to sign in to your account when your tickets are
    ready to be purchased.
</span><span class='heredoc_end'>    HELP
</span>  <span class='kw'>when</span> <span class='symbol'>:early_arrival</span>
    <span class='heredoc_beg'>&lt;&lt;-HELP</span>
<span class='tstring_content'>    If you need to arrive before noon on Friday and are not on the authorized
    list of staff allowed to arrive early, you&#39;ll need to purchase a pass for
    each person in your vehicle.
</span><span class='heredoc_end'>    HELP
</span>  <span class='kw'>when</span> <span class='symbol'>:late_departure</span>
    <span class='heredoc_beg'>&lt;&lt;-HELP</span>
<span class='tstring_content'>    If you need to leave after Sunday @ 2PM and are not on the authorized
    list of staff allowed to leave late, you&#39;ll need to purchase a pass for
    each person in your vehicle.
</span><span class='heredoc_end'>    HELP
</span>  <span class='kw'>when</span> <span class='symbol'>:kids</span>
    <span class='comment'># HACK: This copy is specific for TicketBooth--we&#39;ll have to add a
</span>    <span class='comment'># customization so that this can be set on a per-event basis
</span>    <span class='heredoc_beg'>&lt;&lt;-HELP</span>
<span class='tstring_content'>    The cost of tickets for children will be dependent on how many you bring.
    Unfortunately, kids count against our limit capacity with our contract
    at the site.  As much as we would like to allow kids in for free, we
    simply cannot afford it. However, we know we start excluding families
    from attending if we charge too much for kids to attend, and so we&#39;ve
    attempted to create a pricing model that is reasonable and well-balanced.
    If anyone needs further assistance, check the financial assistance
    checkbox below, and give us a brief explanation of what your needs are.
    We&#39;ll do our best to work with you to figure something out.
</span><span class='heredoc_end'>    HELP
</span>  <span class='kw'>when</span> <span class='symbol'>:cabins</span>
    <span class='heredoc_beg'>&lt;&lt;-HELP</span>
<span class='tstring_content'>    There are a limited number of wood and tent cabins available.
    Both the cabins and the tents are the same price. We encourage everyone to
    bring their own tents and camping gear so that they don&#39;t need a cabin.
    Due to limited availability, we will obviously not be able to grant all
    requests.
</span><span class='heredoc_end'>    HELP
</span>  <span class='kw'>when</span> <span class='symbol'>:address</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>We&#39;ll mail your tickets to this address.</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>when</span> <span class='symbol'>:needs_assistance</span>
    <span class='heredoc_beg'>&lt;&lt;-HELP</span>
<span class='tstring_content'>    We never turn anyone away for financial reasons, and will work with you to
    figure something out. Volunteering for some extra shifts, making payments
    in installments, or requesting discounted tickets are examples of payment
    arrangements we&#39;ve made in the past.
</span><span class='heredoc_end'>    HELP
</span>  <span class='kw'>when</span> <span class='symbol'>:notes</span>
    <span class='heredoc_beg'>&lt;&lt;-HELP</span>
<span class='tstring_content'>    For example, if you checked the box above, tell us what your needs are. If
    you are bringing kids, please include their ages.
</span><span class='heredoc_end'>    HELP
</span>  <span class='kw'>when</span> <span class='symbol'>:community_fund_donation</span>
    <span class='heredoc_beg'>&lt;&lt;-HELP</span>
<span class='tstring_content'>    Your donation to the CFAEA general fund goes toward preserving the culture
    of our community by enabling Art! Music! Fun! Donating is entirely
    voluntary, but anything you can provide helps.
</span><span class='heredoc_end'>    HELP
</span>  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="price_rules_to_json-instance_method">
  
    #<strong>price_rules_to_json</strong>(event)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


59
60
61
62
63
64
65</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/helpers/ticket_requests_helper.rb', line 59</span>

<span class='kw'>def</span> <span class='id identifier rubyid_price_rules_to_json'>price_rules_to_json</span><span class='lparen'>(</span><span class='id identifier rubyid_event'>event</span><span class='rparen'>)</span>
  <span class='const'>Hash</span><span class='lbracket'>[</span>
    <span class='id identifier rubyid_event'>event</span><span class='period'>.</span><span class='id identifier rubyid_price_rules'>price_rules</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_price_rule'>price_rule</span><span class='op'>|</span>
      <span class='lbracket'>[</span> <span class='id identifier rubyid_price_rule'>price_rule</span><span class='period'>.</span><span class='id identifier rubyid_trigger_value'>trigger_value</span><span class='comma'>,</span> <span class='id identifier rubyid_price_rule'>price_rule</span><span class='period'>.</span><span class='id identifier rubyid_price'>price</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='rbracket'>]</span>
    <span class='kw'>end</span>
  <span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_json'>to_json</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="text_class_for_status-instance_method">
  
    #<strong>text_class_for_status</strong>(ticket_request)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


12
13
14
15
16
17
18
19
20
21</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/helpers/ticket_requests_helper.rb', line 12</span>

<span class='kw'>def</span> <span class='id identifier rubyid_text_class_for_status'>text_class_for_status</span><span class='lparen'>(</span><span class='id identifier rubyid_ticket_request'>ticket_request</span><span class='rparen'>)</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_ticket_request'>ticket_request</span><span class='period'>.</span><span class='id identifier rubyid_status'>status</span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>P</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>A</span><span class='tstring_end'>&#39;</span></span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>muted</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>D</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>R</span><span class='tstring_end'>&#39;</span></span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>text-error</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>C</span><span class='tstring_end'>&#39;</span></span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>text-success</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="text_for_status-instance_method">
  
    #<strong>text_for_status</strong>(ticket_request)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/helpers/ticket_requests_helper.rb', line 23</span>

<span class='kw'>def</span> <span class='id identifier rubyid_text_for_status'>text_for_status</span><span class='lparen'>(</span><span class='id identifier rubyid_ticket_request'>ticket_request</span><span class='rparen'>)</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_ticket_request'>ticket_request</span><span class='period'>.</span><span class='id identifier rubyid_status'>status</span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>P</span><span class='tstring_end'>&#39;</span></span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Pending Approval</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>A</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>if</span> <span class='id identifier rubyid_ticket_request'>ticket_request</span><span class='period'>.</span><span class='id identifier rubyid_payment'>payment</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_ticket_request'>ticket_request</span><span class='period'>.</span><span class='id identifier rubyid_payment'>payment</span><span class='period'>.</span><span class='id identifier rubyid_received?'>received?</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Awaiting Payment via Alternate Method</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>else</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Awaiting Payment</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>D</span><span class='tstring_end'>&#39;</span></span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Declined</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>R</span><span class='tstring_end'>&#39;</span></span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Refunded</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>C</span><span class='tstring_end'>&#39;</span></span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Completed</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Wed Apr 20 01:09:46 2022 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.27 (ruby-2.5.8).
</div>

    </div>
  </body>
</html>