%h2 #{@event.name} Staff Sheet

- if @ticket_request
  %p.lead
    This is a community event. Without your help, it can't happen.

  %p
    Volunteering for shifts helps make this event possible, and gives you an
    opportunity to meet new people and contribute to the community.
    You are welcome to sign up for as many shifts as you want. Just don't
    stretch yourself too thin! This is a party and people need to have fun,
    both while working and playing!

  - unless @ticket_request.free?
    %p<>
      When you're ready, please go ahead and
      %b
        = link_to new_payment_url(ticket_request_id: @ticket_request) do
          purchase your ticket

- if current_user.site_admin?
  %h4 Overview
  %ul
    - @jobs.each_with_index do |job, index|
      %li= link_to job.name, "#job-#{index}"

  %hr

  - @jobs.each_with_index do |job, index|
    %h3{ id: "job-#{index}"}= job.name
    %p= job.description

    %table.table.table-bordered.table-striped.time-slots
      %thead
        %tr
          %th.col-time-of-shift Time
          %th.col-shifts-filled Shifts Filled
          %th Volunteers
      %tbody
        - job.time_slots.order(:start_time).each do |time_slot|
          %tr{ class: ('success' if time_slot.volunteered?(current_user)) }
            %td.col-time-of-shift
              =time_slot.start_time.localtime.to_s(:dhmm)
              &ndash;
              =time_slot.end_time.localtime.to_s(:hmm)
            %td.col-shifts-filled
              = time_slot.shifts.count
              \/
              = time_slot.slots
            %td
              .volunteers
                - time_slot.shifts.each do |shift|
                  %span.label{ class: ('label-success' if shift.user == current_user) }
                    = shift.volunteer_name
              .volunteer-form
                - if time_slot.volunteered?(current_user)
                  = link_to event_shift_path(@event,
                                             time_slot.shifts.where(user_id: current_user.id).first),
                    method: :delete,
                    class: 'btn btn-link hover-tooltip',
                    title: 'Remove yourself from this volunteer position' do
                    Unvolunteer
                - elsif time_slot.slots_left?
                  = link_to event_shifts_path(shift: { time_slot_id: time_slot.id,
                                                       user_id: current_user.id }),
                    method: :post,
                    class: 'volunteer-btn btn btn-success hover-tooltip',
                    title: volunteer_button_hover_text do
                    Volunteer
- else
  %p.lead.text-warning
    The volunteer shift signup sheet is currently being developed. You can still
    purchase your tickets, but please come back later to sign up for a shift (we'll
    send you an email when we're ready to start taking shift signups)
